<view class="container">
  <view class="filter-section">
    <view class="filter-header">
      <text class="filter-title">ç­›é€‰æ¡ä»¶</text>
      <view class="filter-reset" bindtap="onResetFilter">
        <text class="reset-text">é‡ç½®</text>
      </view>
    </view>
    
    <view class="filter-content">
      <view class="filter-row">
        <picker 
          mode="selector" 
          range="{{filterTypes}}" 
          bindchange="onFilterTypeChange"
          value="{{filterType === 'ALL' ? 0 : filterType === 'INCOME' ? 1 : 2}}"
        >
          <view class="filter-item">
            <view class="filter-left">
              <text class="filter-icon">ğŸ“Š</text>
              <text class="filter-label">äº¤æ˜“ç±»å‹</text>
            </view>
            <view class="filter-right">
              <text class="filter-value {{filterType !== 'ALL' ? 'active' : ''}}">{{filterTypes[filterType === 'ALL' ? 0 : filterType === 'INCOME' ? 1 : 2]}}</text>
              <text class="filter-arrow">â€º</text>
            </view>
          </view>
        </picker>
      </view>

      <view class="filter-divider"></view>

      <view class="filter-row">
        <picker mode="date" value="{{startDate}}" bindchange="onStartDateChange">
          <view class="filter-item">
            <view class="filter-left">
              <text class="filter-icon">ğŸ“…</text>
              <text class="filter-label">å¼€å§‹æ—¥æœŸ</text>
            </view>
            <view class="filter-right">
              <text class="filter-value {{startDate ? 'active' : ''}}">{{startDate || 'ä¸é™'}}</text>
              <text class="filter-arrow">â€º</text>
            </view>
          </view>
        </picker>
      </view>

      <view class="filter-divider"></view>

      <view class="filter-row">
        <picker mode="date" value="{{endDate}}" bindchange="onEndDateChange">
          <view class="filter-item">
            <view class="filter-left">
              <text class="filter-icon">ğŸ“…</text>
              <text class="filter-label">ç»“æŸæ—¥æœŸ</text>
            </view>
            <view class="filter-right">
              <text class="filter-value {{endDate ? 'active' : ''}}">{{endDate || 'ä¸é™'}}</text>
              <text class="filter-arrow">â€º</text>
            </view>
          </view>
        </picker>
      </view>
    </view>
  </view>

  <view class="transaction-list">
    <view wx:if="{{transactions.length === 0 && !loading}}" class="empty">
      <text>æš‚æ— äº¤æ˜“è®°å½•</text>
    </view>

    <view 
      wx:for="{{transactions}}" 
      wx:key="id" 
      class="transaction-item {{isToday(item.date) ? 'today' : ''}}"
      bindtap="goToDetail"
      data-id="{{item.id}}"
    >
      <view class="transaction-date-badge">
        <text class="date-month">{{formatDateOnly(item.date).slice(5, 7)}}æœˆ</text>
        <text class="date-day">{{formatDateOnly(item.date).slice(8, 10)}}</text>
      </view>
      <view class="transaction-main">
        <view class="transaction-info">
          <text class="transaction-category">{{item.category}}</text>
          <text class="transaction-description" wx:if="{{item.description}}">{{item.description}}</text>
        </view>
        <view class="transaction-amount {{item.type === 'INCOME' ? 'income' : 'expense'}}">
          {{item.type === 'INCOME' ? '+' : '-'}}Â¥{{item.amount}}
        </view>
      </view>
      <view class="transaction-footer">
        <text class="transaction-time">{{formatDate(item.createdAt)}}</text>
        <view class="delete-btn" catchtap="onDelete" data-id="{{item.id}}" data-index="{{index}}">
          <text>åˆ é™¤</text>
        </view>
      </view>
    </view>

    <view wx:if="{{loading}}" class="loading">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <view wx:if="{{!hasMore && transactions.length > 0}}" class="no-more">
      <text>æ²¡æœ‰æ›´å¤šäº†</text>
    </view>
  </view>
</view>
