# Tasks: Test Family Groups with Chrome DevTools MCP

## Phase 1: 环境准备与验证

- [ ] **Task 1.1**: 验证开发环境配置
  - 确认 Next.js 开发服务器可启动（`npm run dev`）
  - 确认数据库连接正常
  - 确认 Chrome DevTools MCP 服务器已配置
  - 验证可以打开浏览器并访问 localhost:3000

- [ ] **Task 1.2**: 清理测试数据
  - 查询数据库是否存在测试账号（test_family_*）
  - 删除已存在的测试账号及相关数据
  - 验证清理成功

## Phase 2: 注册流程测试

- [ ] **Task 2.1**: 测试用户注册功能
  - 使用 Chrome DevTools 打开注册页面
  - 填写用户信息（test_family_1）
  - 提交注册表单
  - 验证注册成功并跳转到 dashboard
  - 重复注册 test_family_2 和 test_family_3

- [ ] **Task 2.2**: 测试登录功能
  - 退出登录
  - 使用注册的账号登录
  - 验证登录成功
  - 验证会话状态正确

## Phase 3: 创建家庭组测试

- [ ] **Task 3.1**: 测试创建家庭组功能
  - 以 test_family_1 登录
  - 导航到家庭组页面（/dashboard/family-groups）
  - 点击"创建家庭组"按钮
  - 输入家庭组名称
  - 提交创建
  - 验证创建成功并显示邀请码

- [ ] **Task 3.2**: 验证邀请码格式
  - 检查邀请码是否为8位字符
  - 检查邀请码是否为大写字母+数字
  - 测试邀请码复制功能
  - 验证复制到剪贴板成功

## Phase 4: 成员加入测试

- [ ] **Task 4.1**: 测试第一个成员加入
  - 退出 test_family_1
  - 以 test_family_2 登录
  - 导航到家庭组页面
  - 点击"加入家庭组"按钮
  - 输入邀请码
  - 提交加入
  - 验证加入成功并显示成员列表

- [ ] **Task 4.2**: 测试第二个成员加入
  - 退出 test_family_2
  - 以 test_family_3 登录
  - 重复加入流程
  - 验证能看到所有3个成员
  - 验证创建者标识显示正确

## Phase 5: 数据访问测试

- [ ] **Task 5.1**: 测试数据共享功能
  - 以 test_family_3 登录
  - 创建几笔测试交易记录
  - 退出登录
  - 以 test_family_1 登录
  - 验证能看到 test_family_3 的交易记录
  - 验证家庭组统计数据正确

- [ ] **Task 5.2**: 测试统计数据准确性
  - 验证个人统计数据显示
  - 验证成员统计列表显示
  - 验证家庭总计数据正确
  - 验证交易笔数统计正确

## Phase 6: 退出家庭组测试

- [ ] **Task 6.1**: 测试成员退出功能
  - 以 test_family_2 登录
  - 点击"退出家庭组"按钮
  - 确认退出
  - 验证退出成功
  - 验证返回未加入状态

- [ ] **Task 6.2**: 验证退出后数据隔离
  - 尝试访问原家庭组数据
  - 验证无法访问（403或404错误）
  - 验证其他成员列表中不再显示已退出成员

## Phase 7: 解散家庭组测试

- [ ] **Task 7.1**: 测试创建者解散功能
  - 以 test_family_1（创建者）登录
  - 点击"解散家庭组"按钮
  - 确认解散
  - 验证解散成功

- [ ] **Task 7.2**: 验证解散后数据清理
  - 验证家庭组不再存在
  - 切换到 test_family_3 账号
  - 验证也无法访问家庭组
  - 验证数据库中家庭组记录已删除

## Phase 8: 边界条件测试

- [ ] **Task 8.1**: 测试重复加入限制
  - test_family_1 创建新家庭组
  - test_family_2 加入
  - 尝试再次加入（应该失败）
  - 验证错误提示正确

- [ ] **Task 8.2**: 测试创建者退出限制
  - test_family_1 尝试退出（应该失败）
  - 验证错误提示正确

- [ ] **Task 8.3**: 测试非创建者解散限制
  - test_family_2 尝试解散（应该失败）
  - 验证错误提示正确

- [ ] **Task 8.4**: 测试无效邀请码
  - test_family_3 尝试使用无效邀请码加入
  - 验证错误提示正确
  - 测试不存在的邀请码
  - 测试格式错误的邀请码

## Phase 9: 问题修复与同步

- [ ] **Task 9.1**: 记录发现的问题
  - 整理所有测试过程中发现的问题
  - 按严重程度分类（High/Medium/Low）
  - 记录重现步骤和错误信息

- [ ] **Task 9.2**: 修复 Web 端问题
  - 根据优先级修复发现的问题
  - 验证修复有效
  - 确保通过 ESLint 和类型检查

- [ ] **Task 9.3**: 同步修复小程序端
  - 审查小程序端相关代码
  - 查找与 Web 端相同的逻辑
  - 实施相同修复
  - 验证小程序端功能正常

## Phase 10: 文档与总结

- [ ] **Task 10.1**: 编写测试报告
  - 总结测试覆盖率
  - 列出所有测试用例及结果
  - 详细记录发现的问题和修复方案

- [ ] **Task 10.2**: 保存测试证据
  - 保存关键步骤的页面截图
  - 保存网络请求日志
  - 记录测试脚本和命令

## 并行化机会

以下任务可以并行执行：
- **Task 2.1-2.2**: 注册流程可以批量创建测试账号
- **Task 5.1-5.2**: 数据访问测试可以同时验证多个方面
- **Task 9.2-9.3**: Web 端和小程序端修复可以同时进行审查

## 依赖关系

```
Phase 1 (环境准备)
  ↓
Phase 2 (注册测试)
  ↓
Phase 3 (创建家庭组)
  ↓
Phase 4 (成员加入)
  ↓
Phase 5 (数据访问)
  ↓
Phase 6 (退出测试)
  ↓
Phase 7 (解散测试)
  ↓
Phase 8 (边界条件)
  ↓
Phase 9 (问题修复)
  ↓
Phase 10 (文档总结)
```

**关键依赖**:
- 所有测试依赖 Phase 1 完成
- Phase 4 依赖 Phase 3（需要先创建家庭组）
- Phase 5 依赖 Phase 4（需要先有成员）
- Phase 7 依赖 Phase 6（需要先测试退出）
- Phase 9 依赖所有测试阶段完成（发现所有问题后统一修复）
